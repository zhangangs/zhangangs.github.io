<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="apple-mobile-web-app-title" content="飞鱼"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f0f0f0"><meta name="theme-color" content="#ffffff"><link rel="manifest" href="/manifest.json"><meta name="keywords" content="飞鱼,前端,技术博客,心情日记"><meta name="description" content="随手记录工作生活中的点点滴滴,让普通的生活中多一点小小的惊喜..."><title>python自动填写网页表单-飞鱼</title><link rel="apple-touch-icon" href="/images/android-chrome-192x192.png"><link rel="stylesheet" href="/css/normalize.css"><link rel="stylesheet" href="/css/hexo-theme-adoubi.css"><link rel="icon" href="/images/favicon.ico"></head><body><div class="content"><div class="author-info post-header"><a href="/archives/" title="返回列表页"><img src="/images/icon_face.jpg"></a><a class="jump" href="#" title="返回列表页" onclick="history.back(-1)"> <img src="/images/icon-back.svg"><span>返回</span></a></div><h4 class="post-title-wrapper"><p class="post-title">python自动填写网页表单</p></h4><div class="post-date"><p>Author:<a href="/about">飞鱼</a></p><p>Date:<time datetime="2020-02-20T16:00:00.000Z">2020-02-21</time></p></div><div class="post-content"><p>每天都要在OA中填写每日身体情况反馈表，内容都是重复的，最重要的就是填写每天的体温，而我经常又忘记填写，琢磨着写个自动任务帮我搞定。</p>
<p>就简单的写个python定时任务，每天下午2：00定时帮我填一下表。</p>
<p>原理就是模拟人的操作方式，访问网站，点击登录，选择navbar，填写表单和保存表单等操作。</p>
<p>代码很简单，第一次做这个，代码写的不咋好，贴一下主要的代码，做一个简单的记录，代码如下所示：</p>
<p><strong>index.py</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> task</span><br><span class="line"><span class="keyword">import</span> schedule</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line">print(<span class="string">"执行开始！！！！"</span>)</span><br><span class="line"></span><br><span class="line">schedule.every().day.at(<span class="string">'14:00'</span>).do(task.taskFun)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'执行时间：'</span> + datetime.datetime.now().strftime(<span class="string">'%Y-%m-%d %H:%M:%S'</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    schedule.run_pending()</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure></p>
<p><strong> task.py </strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">taskFun</span><span class="params">()</span>:</span></span><br><span class="line">    driver = webdriver.Chrome(<span class="string">"C:\Program Files (x86)\Google\Chrome\Application\chromedriver.exe"</span>)</span><br><span class="line"></span><br><span class="line">    driver.set_window_size(<span class="number">800</span>, <span class="number">800</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 访问网页地址</span></span><br><span class="line">    driver.get(url=<span class="string">'http://********/?m=login'</span>)</span><br><span class="line"></span><br><span class="line">    driver.implicitly_wait(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 输入用户名</span></span><br><span class="line">    driver.find_element_by_xpath(<span class="string">'//*[@id="loginview0"]/div[1]/div/input'</span>).send_keys(<span class="string">'####'</span>)</span><br><span class="line">    <span class="comment"># 输入密码</span></span><br><span class="line">    driver.find_element_by_xpath(<span class="string">'//*[@id="loginview0"]/div[3]/div/input'</span>).send_keys(<span class="string">'####'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 登录</span></span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line">    driver.find_element_by_xpath(<span class="string">'/html/body/div/div[4]/form/div[4]/button'</span>).click()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># nav选择</span></span><br><span class="line">    time.sleep(<span class="number">3</span>)</span><br><span class="line">    driver.find_element_by_xpath(<span class="string">'//*[@id="topmenudiv"]/span[3]'</span>).click()</span><br><span class="line"></span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    driver.find_element_by_css_selector(<span class="string">"#menu_list_num410"</span>).click()</span><br><span class="line"></span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># 点击新增按钮</span></span><br><span class="line">    driver.find_element_by_xpath(</span><br><span class="line">        <span class="string">'/html/body/table/tbody/tr/td[3]/div/div[4]/div/div[2]/div[1]/table/tbody/tr/td[1]/button'</span>).click()</span><br><span class="line"></span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># 进入到iframe中选择元素</span></span><br><span class="line">    driver.switch_to.frame(<span class="string">"openinputiframe"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 填写数据</span></span><br><span class="line">    driver.find_element_by_xpath(<span class="string">'//*[@id="div_temperature_am"]/input'</span>).send_keys(<span class="string">'36.5'</span>)</span><br><span class="line">    driver.find_element_by_xpath(<span class="string">'//*[@id="div_temperature_pm"]/input'</span>).send_keys(<span class="string">'36.5'</span>)</span><br><span class="line"></span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="comment"># 提交表单</span></span><br><span class="line">    driver.find_element_by_xpath(<span class="string">'//*[@id="AltS"]'</span>).click()</span><br><span class="line"></span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="comment"># 退出程序</span></span><br><span class="line">    driver.quit()</span><br></pre></td></tr></table></figure>
<p><strong>使用方法</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python index.py</span><br></pre></td></tr></table></figure></p>
<p>完成，一直跑起来就可以了。</p>
</div></div><div class="footer"><div class="footer-copyright">Theme By <a href="https://github.com/shinux/hexo-theme-adoubi" target="_blank">Adoubi</a> , Modify By <a href="https://github.com/zhangangs" target="_blank">Veiss</a>, Powered By Hexo.</div></div></body></html>